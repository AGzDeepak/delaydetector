{% extends 'base.html' %}
{% block title %}Dashboard Â· Awareness Delay{% endblock %}
{% block content %}
<div class="dashboard-container">
  <div class="dashboard-header glass-surface">
    <h2>ğŸ“Š Awareness Inequality Dashboard</h2>
    <p class="subtitle">Live data on opportunity delays across regions</p>
  </div>

  <div class="metrics-grid">
    <div class="metric-card metric-card-primary fade-in" style="animation-delay: 0.1s">
      <div class="metric-icon">ğŸ“Š</div>
      <div class="metric-content">
        <h3>Total Records</h3>
        <p class="metric-value">{{ data.total }}</p>
        <span class="metric-label">submissions</span>
      </div>
    </div>

    <div class="metric-card metric-card-secondary fade-in" style="animation-delay: 0.2s">
      <div class="metric-icon">â±ï¸</div>
      <div class="metric-content">
        <h3>Avg Delay</h3>
        <p class="metric-value">{{ data.avg_delay or 'â€”' }}</p>
        <span class="metric-label">days</span>
      </div>
    </div>

    <div class="metric-card metric-card-warning fade-in" style="animation-delay: 0.3s">
      <div class="metric-icon">âš ï¸</div>
      <div class="metric-content">
        <h3>Late Awareness</h3>
        <p class="metric-value">{{ data.late_percent }}%</p>
        <span class="metric-label">of users</span>
      </div>
    </div>

    <div class="metric-card metric-card-info fade-in" style="animation-delay: 0.4s">
      <div class="metric-icon">ğŸ“ˆ</div>
      <div class="metric-content">
        <h3>Avg Delay Ratio</h3>
        <p class="metric-value">{{ data.avg_delay_ratio or 'â€”' }}</p>
        <span class="metric-label">opportunity lost</span>
      </div>
    </div>
  </div>

  {% if data.rows %}
  <div class="summary-panel glass-surface fade-in" style="animation-delay: 0.5s">
    <div class="summary-header">
      <h3>Submission Highlights</h3>
      <span>Last {{ data.rows|length }} submissions</span>
    </div>
    <div class="summary-grid">
      <div class="summary-card">
        <span>Total</span>
        <strong>{{ data.total }}</strong>
      </div>
      <div class="summary-card">
        <span>Avg Delay</span>
        <strong>{{ data.avg_delay or 'â€”' }} days</strong>
      </div>
      <div class="summary-card">
        <span>Late %</span>
        <strong>{{ data.late_percent }}%</strong>
      </div>
    </div>
    <div class="summary-tags">
      {% for label, count in data.categories.items() %}
      <span class="summary-tag">{{ label }} Â· {{ count }}</span>
      {% endfor %}
    </div>
  </div>

  <div class="data-section fade-in glass-surface" style="animation-delay: 0.6s">
    <h3 class="section-title">ğŸ“‹ Recent Submissions</h3>
    <div class="table-wrapper">
      <table class="data-table">
        <thead>
          <tr>
            <th>Opportunity</th>
            <th>Delay (days)</th>
            <th>Category</th>
            <th>Delay Ratio</th>
            <th>Announcement</th>
            <th>Deadline</th>
            <th>College Type</th>
            <th>Region</th>
            <th>Status</th>
          </tr>
        </thead>
        <tbody>
          {% for r in data.rows|reverse|list %}
          <tr class="table-row-animate">
            <td><strong>{{ r.opportunity_name }}</strong></td>
            <td>{{ r.delay_days or 'â€”' }}</td>
            <td>
              <span class="category-badge category-{{ r.delay_category|lower|replace(' ', '-') }}">
                {{ r.delay_category }}
              </span>
            </td>
            <td>{{ (r.delay_ratio * 100)|round|int if r.delay_ratio else 'â€”' }}%</td>
            <td>{{ r.announcement_date or 'â€”' }}</td>
            <td>{{ r.deadline or 'â€”' }}</td>
            <td>{{ r.college_type or 'â€”' }}</td>
            <td>{{ r.region or 'â€”' }}</td>
            <td>{{ r.status or 'â€”' }}</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>
  {% else %}
  <div class="empty-state fade-in" style="animation-delay: 0.6s">
    <div class="empty-icon">ğŸ“­</div>
    <h3>No Data Yet</h3>
    <p>Be the first to submit awareness data and help us measure opportunity inequality.</p>
    <a href="/submit" class="btn">Submit Your First Entry</a>
  </div>
  {% endif %}
</div>

{% endblock %}
